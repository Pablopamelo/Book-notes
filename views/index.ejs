<%- include("partials/header.ejs") %>
<link href = "/styles/main.css" rel = "stylesheet">

        <div id = "mainCont">
            <main>

                <div class = "floatingCont">

                    <div id = "filtersCont">

                        <div id = "filters">

                            <ul id = "filterOptions">
                                <li class = "filter"></li>
                                <li class = "filter"></li>
                                <li class = "filter"></li>
                            </ul>

                        </div>

                    </div>

                    <div id = "contentCont">

                        <form id = "bookForm" method = "POST" action = "/new/0"></form>
                        
                        <div id = "books">

                                <div id = "addBook" class = "book">
                                    <div id = "filler">
                                        <div id = "plus">+</div>
                                    </div>
                                </div>

                            <% if(locals.books){ %>
                                <% books.forEach((book) => { %>
                                    <div onclick = "location.href = '/book/<%= book.id %>'" class = "book" id = "book<%= book.id %>">

                                        <div class = "top">
                                            <div class = "cover" id = "cover<%= book.id %>">
                                                <img class = "coverImg" src = "<%= book.cover %>">
                                            </div>
                                        </div>

                                        <div class = "bottom">
                                            <div class = "bookTitle"> <%= book.title %> </div>

                                            <div class = "rating">
                                                <%= "*".repeat(book.rating); %>
                                            </div>

                                            <form class = "actions" method = "POST">
                                                <button class = "edit" type = "submit" formaction = "/new/<%= book.id %>" onclick="event.stopPropagation()">E</button>

                                                <button class = "delete" type = "submit" formaction = "/delete/<%= book.id %>" onclick="event.stopPropagation()">X</button>
                                            </form>
                                        </div>
                                    </div>
                                <% }); %>
                            <% } %>
                        </div>

                    </div>
                </div>
                
            </main>
        </div>

    <script>
        document.getElementById('addBook').addEventListener('click', function () {
            document.getElementById('bookForm').requestSubmit();
        });
    </script>
    
<%- include("partials/footer.ejs") %>